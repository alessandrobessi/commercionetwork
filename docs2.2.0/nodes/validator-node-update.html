<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Updating a validator | Commercio.network Documentation</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/icon.png">
    <meta name="description" content="Documentation for the Commercio.network blockchain.">
    
    <link rel="preload" href="/assets/css/0.styles.8e427097.css" as="style"><link rel="preload" href="/assets/js/app.cb75fd21.js" as="script"><link rel="preload" href="/assets/js/2.0061f73b.js" as="script"><link rel="preload" href="/assets/js/78.05820fe7.js" as="script"><link rel="prefetch" href="/assets/js/10.931d6214.js"><link rel="prefetch" href="/assets/js/100.086d7e86.js"><link rel="prefetch" href="/assets/js/101.0bbb8739.js"><link rel="prefetch" href="/assets/js/102.b3352bfd.js"><link rel="prefetch" href="/assets/js/103.7cb80197.js"><link rel="prefetch" href="/assets/js/104.23c1936c.js"><link rel="prefetch" href="/assets/js/105.b6e89def.js"><link rel="prefetch" href="/assets/js/106.31e3cb51.js"><link rel="prefetch" href="/assets/js/107.b92be990.js"><link rel="prefetch" href="/assets/js/108.105b5e43.js"><link rel="prefetch" href="/assets/js/109.b42acf70.js"><link rel="prefetch" href="/assets/js/11.8ddc7066.js"><link rel="prefetch" href="/assets/js/110.e6cc55bf.js"><link rel="prefetch" href="/assets/js/111.6e4d5285.js"><link rel="prefetch" href="/assets/js/112.12d6051a.js"><link rel="prefetch" href="/assets/js/113.930ac4c5.js"><link rel="prefetch" href="/assets/js/114.fc4e28c7.js"><link rel="prefetch" href="/assets/js/115.c0ae5cae.js"><link rel="prefetch" href="/assets/js/116.6d486193.js"><link rel="prefetch" href="/assets/js/117.43129147.js"><link rel="prefetch" href="/assets/js/118.8b781568.js"><link rel="prefetch" href="/assets/js/119.609104b1.js"><link rel="prefetch" href="/assets/js/12.0adcf7ea.js"><link rel="prefetch" href="/assets/js/120.db5f334e.js"><link rel="prefetch" href="/assets/js/121.87d40352.js"><link rel="prefetch" href="/assets/js/122.c17f49d2.js"><link rel="prefetch" href="/assets/js/123.fc882d67.js"><link rel="prefetch" href="/assets/js/124.95c5368d.js"><link rel="prefetch" href="/assets/js/125.0c9fd454.js"><link rel="prefetch" href="/assets/js/126.6dcd7c7b.js"><link rel="prefetch" href="/assets/js/127.03d7f6f7.js"><link rel="prefetch" href="/assets/js/128.dad2c5e5.js"><link rel="prefetch" href="/assets/js/129.ac3b5dd9.js"><link rel="prefetch" href="/assets/js/13.cabca4a1.js"><link rel="prefetch" href="/assets/js/130.c13e7c05.js"><link rel="prefetch" href="/assets/js/131.a1eb48a4.js"><link rel="prefetch" href="/assets/js/132.8b017cf2.js"><link rel="prefetch" href="/assets/js/133.6d4df54b.js"><link rel="prefetch" href="/assets/js/134.a17eb3f4.js"><link rel="prefetch" href="/assets/js/135.338520b7.js"><link rel="prefetch" href="/assets/js/136.2bb5d900.js"><link rel="prefetch" href="/assets/js/137.c4d35f31.js"><link rel="prefetch" href="/assets/js/138.08d0b603.js"><link rel="prefetch" href="/assets/js/139.b93383bc.js"><link rel="prefetch" href="/assets/js/14.9c6179e0.js"><link rel="prefetch" href="/assets/js/140.69169118.js"><link rel="prefetch" href="/assets/js/141.db103d75.js"><link rel="prefetch" href="/assets/js/142.03c046aa.js"><link rel="prefetch" href="/assets/js/143.8ce01721.js"><link rel="prefetch" href="/assets/js/144.93b58be6.js"><link rel="prefetch" href="/assets/js/145.b6d4f5f2.js"><link rel="prefetch" href="/assets/js/146.35944350.js"><link rel="prefetch" href="/assets/js/147.a4e98330.js"><link rel="prefetch" href="/assets/js/148.47096381.js"><link rel="prefetch" href="/assets/js/149.45a81afa.js"><link rel="prefetch" href="/assets/js/15.de799c66.js"><link rel="prefetch" href="/assets/js/150.1962d395.js"><link rel="prefetch" href="/assets/js/151.f5b09bcc.js"><link rel="prefetch" href="/assets/js/152.d368e91a.js"><link rel="prefetch" href="/assets/js/153.e079206d.js"><link rel="prefetch" href="/assets/js/154.9a5cfabc.js"><link rel="prefetch" href="/assets/js/155.caf3bb23.js"><link rel="prefetch" href="/assets/js/156.e14a3233.js"><link rel="prefetch" href="/assets/js/157.0558b91d.js"><link rel="prefetch" href="/assets/js/158.3ff6f109.js"><link rel="prefetch" href="/assets/js/159.7eefaad3.js"><link rel="prefetch" href="/assets/js/16.77727cbc.js"><link rel="prefetch" href="/assets/js/160.7a3b7358.js"><link rel="prefetch" href="/assets/js/161.910b6cf3.js"><link rel="prefetch" href="/assets/js/17.415fa960.js"><link rel="prefetch" href="/assets/js/18.e7ea708c.js"><link rel="prefetch" href="/assets/js/19.e08a6e00.js"><link rel="prefetch" href="/assets/js/20.3c940031.js"><link rel="prefetch" href="/assets/js/21.de98bfe9.js"><link rel="prefetch" href="/assets/js/22.889386d6.js"><link rel="prefetch" href="/assets/js/23.4d28d7c3.js"><link rel="prefetch" href="/assets/js/24.f002d79d.js"><link rel="prefetch" href="/assets/js/25.3bed7e19.js"><link rel="prefetch" href="/assets/js/26.af23018b.js"><link rel="prefetch" href="/assets/js/27.e1397305.js"><link rel="prefetch" href="/assets/js/28.77f3b366.js"><link rel="prefetch" href="/assets/js/29.ce18d8a3.js"><link rel="prefetch" href="/assets/js/3.4d86a545.js"><link rel="prefetch" href="/assets/js/30.67e26388.js"><link rel="prefetch" href="/assets/js/31.097c3130.js"><link rel="prefetch" href="/assets/js/32.8dad699f.js"><link rel="prefetch" href="/assets/js/33.61d9a078.js"><link rel="prefetch" href="/assets/js/34.2bdb8713.js"><link rel="prefetch" href="/assets/js/35.6c199511.js"><link rel="prefetch" href="/assets/js/36.2db75880.js"><link rel="prefetch" href="/assets/js/37.a6ceae78.js"><link rel="prefetch" href="/assets/js/38.b8783a24.js"><link rel="prefetch" href="/assets/js/39.d329535a.js"><link rel="prefetch" href="/assets/js/4.879d1fa5.js"><link rel="prefetch" href="/assets/js/40.ec8fbd56.js"><link rel="prefetch" href="/assets/js/41.3f5f9e5a.js"><link rel="prefetch" href="/assets/js/42.fa581384.js"><link rel="prefetch" href="/assets/js/43.e3bc68ee.js"><link rel="prefetch" href="/assets/js/44.5516b275.js"><link rel="prefetch" href="/assets/js/45.d171a0f6.js"><link rel="prefetch" href="/assets/js/46.d6afe36f.js"><link rel="prefetch" href="/assets/js/47.d6a8acf1.js"><link rel="prefetch" href="/assets/js/48.1ffd54b3.js"><link rel="prefetch" href="/assets/js/49.a1faef49.js"><link rel="prefetch" href="/assets/js/5.54a313ae.js"><link rel="prefetch" href="/assets/js/50.ddb965bc.js"><link rel="prefetch" href="/assets/js/51.0316f3ac.js"><link rel="prefetch" href="/assets/js/52.14bfe7e8.js"><link rel="prefetch" href="/assets/js/53.c9425308.js"><link rel="prefetch" href="/assets/js/54.334205d3.js"><link rel="prefetch" href="/assets/js/55.923db337.js"><link rel="prefetch" href="/assets/js/56.4f3cc521.js"><link rel="prefetch" href="/assets/js/57.5e7c371a.js"><link rel="prefetch" href="/assets/js/58.4f7bcaff.js"><link rel="prefetch" href="/assets/js/59.635fc8f1.js"><link rel="prefetch" href="/assets/js/6.6f0e1a91.js"><link rel="prefetch" href="/assets/js/60.95901bbe.js"><link rel="prefetch" href="/assets/js/61.587762d2.js"><link rel="prefetch" href="/assets/js/62.9376bc75.js"><link rel="prefetch" href="/assets/js/63.5cb2bf93.js"><link rel="prefetch" href="/assets/js/64.675df91f.js"><link rel="prefetch" href="/assets/js/65.48745192.js"><link rel="prefetch" href="/assets/js/66.4aad81ee.js"><link rel="prefetch" href="/assets/js/67.24215fe3.js"><link rel="prefetch" href="/assets/js/68.657fc1f9.js"><link rel="prefetch" href="/assets/js/69.21dc57fc.js"><link rel="prefetch" href="/assets/js/7.84b519fd.js"><link rel="prefetch" href="/assets/js/70.c291b2e1.js"><link rel="prefetch" href="/assets/js/71.b3f40fc2.js"><link rel="prefetch" href="/assets/js/72.24506260.js"><link rel="prefetch" href="/assets/js/73.ce4cd29c.js"><link rel="prefetch" href="/assets/js/74.c3090e26.js"><link rel="prefetch" href="/assets/js/75.2723c298.js"><link rel="prefetch" href="/assets/js/76.01750c07.js"><link rel="prefetch" href="/assets/js/77.7165d3be.js"><link rel="prefetch" href="/assets/js/79.712f63e9.js"><link rel="prefetch" href="/assets/js/8.98ad7fb6.js"><link rel="prefetch" href="/assets/js/80.1bf00a0f.js"><link rel="prefetch" href="/assets/js/81.a1e46c7e.js"><link rel="prefetch" href="/assets/js/82.8fb880a5.js"><link rel="prefetch" href="/assets/js/83.52547857.js"><link rel="prefetch" href="/assets/js/84.727a8128.js"><link rel="prefetch" href="/assets/js/85.d0eb162d.js"><link rel="prefetch" href="/assets/js/86.fc6cc538.js"><link rel="prefetch" href="/assets/js/87.e278536e.js"><link rel="prefetch" href="/assets/js/88.74a153b2.js"><link rel="prefetch" href="/assets/js/89.f7445697.js"><link rel="prefetch" href="/assets/js/9.249582a7.js"><link rel="prefetch" href="/assets/js/90.37b2a39d.js"><link rel="prefetch" href="/assets/js/91.917e45d0.js"><link rel="prefetch" href="/assets/js/92.bebf8838.js"><link rel="prefetch" href="/assets/js/93.1e2455ce.js"><link rel="prefetch" href="/assets/js/94.d62c3c92.js"><link rel="prefetch" href="/assets/js/95.da20fbd3.js"><link rel="prefetch" href="/assets/js/96.b0168a1b.js"><link rel="prefetch" href="/assets/js/97.d28a7091.js"><link rel="prefetch" href="/assets/js/98.a92db652.js"><link rel="prefetch" href="/assets/js/99.7f24df42.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8e427097.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/icon.png" alt="Commercio.network Documentation" class="logo"> <span class="site-name can-hide">Commercio.network Documentation</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Versions" class="dropdown-title"><span class="title">Versions</span> <span class="arrow down"></span></button> <button type="button" aria-label="Versions" class="mobile-dropdown-title"><span class="title">Versions</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">
  ver 3.0.0
</a></li><li class="dropdown-item"><!----> <a href="/docs2.2.0/" class="nav-link router-link-active">
  ver 2.2.0
</a></li><li class="dropdown-item"><!----> <a href="/docs2.1.2/" class="nav-link">
  ver 2.1.2
</a></li></ul></div></div><div class="nav-item"><a href="https://commercio.network" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Commercio.network
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/commercionetwork/commercionetwork" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Versions" class="dropdown-title"><span class="title">Versions</span> <span class="arrow down"></span></button> <button type="button" aria-label="Versions" class="mobile-dropdown-title"><span class="title">Versions</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">
  ver 3.0.0
</a></li><li class="dropdown-item"><!----> <a href="/docs2.2.0/" class="nav-link router-link-active">
  ver 2.2.0
</a></li><li class="dropdown-item"><!----> <a href="/docs2.1.2/" class="nav-link">
  ver 2.1.2
</a></li></ul></div></div><div class="nav-item"><a href="https://commercio.network" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Commercio.network
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/commercionetwork/commercionetwork" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Running Nodes</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/nodes/" class="sidebar-link">Commercio.network overview</a></li><li><a href="/nodes/hardware-requirements.html" class="sidebar-link">Hardware requirements</a></li><li><a href="/nodes/full-node-installation.html" class="sidebar-link">Installing a full node</a></li><li><a href="/nodes/validator-node-installation.html" class="sidebar-link">Becoming a validator</a></li><li><a href="/nodes/validator-node-handling.html" class="sidebar-link">Handling a validator</a></li><li><a href="/nodes/validator-node-update.html" class="sidebar-link">Updating a validator</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>API Developers</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/app_developers/commercioapi-introduction.html" class="sidebar-link">Introduction to CommercioAPI</a></li><li><a href="/app_developers/commercioapi-authentication.html" class="sidebar-link">Authentication process</a></li><li><a href="/app_developers/commercioapi-wallet.html" class="sidebar-link">Wallet</a></li><li><a href="/app_developers/commercioapi-sharedoc.html" class="sidebar-link">ShareDoc</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Custom Modules (WIP)</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>Government</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/modules/government/" class="sidebar-link">Concepts</a></li><li><a href="/modules/government/01_state.html" class="sidebar-link">State</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Did</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Documents</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>CommercioMint</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>CommercioKYC</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Vbr</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>ver 2.2.0</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs2.2.0/" aria-current="page" class="sidebar-link">ver 2.2.0</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>Nodes</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs2.2.0/nodes/" aria-current="page" class="sidebar-link">Introduction</a></li><li><a href="/docs2.2.0/nodes/hardware-requirements.html" class="sidebar-link">Hardware requirements</a></li><li><a href="/docs2.2.0/nodes/full-node-installation.html" class="sidebar-link">Installing a full node</a></li><li><a href="/docs2.2.0/nodes/validator-node-installation.html" class="sidebar-link">Becoming a validator</a></li><li><a href="/docs2.2.0/nodes/validator-node-handling.html" class="sidebar-link">Handling a validator</a></li><li><a href="/docs2.2.0/nodes/validator-node-update.html" aria-current="page" class="active sidebar-link">Updating a validator</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#update-type-1-hard-fork" class="sidebar-link">Update type 1 - Hard fork</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#preliminary-risks" class="sidebar-link">Preliminary/Risks</a></li><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#install-support-software" class="sidebar-link">Install support software</a></li><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#setup-environment" class="sidebar-link">Setup environment</a></li><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#compile-new-executables" class="sidebar-link">Compile new executables</a></li><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#setup-height-to-stop-the-chain" class="sidebar-link">Setup height to stop the chain</a></li><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#control-if-chain-is-stopped" class="sidebar-link">Control if chain is stopped</a></li><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#stop-services" class="sidebar-link">Stop services</a></li><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#export-chain-state" class="sidebar-link">Export chain state</a></li><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#backup-executables" class="sidebar-link">Backup executables</a></li><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#changing-executables" class="sidebar-link">Changing executables</a></li><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#migrate-chain" class="sidebar-link">Migrate chain</a></li><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#check-hash-of-genesis" class="sidebar-link">Check hash of genesis</a></li><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#backup" class="sidebar-link">Backup</a></li><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#reset-chain-and-change-geneis-file" class="sidebar-link">Reset chain and change geneis file</a></li><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#restart-chain" class="sidebar-link">Restart chain</a></li><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#control-chain-restart" class="sidebar-link">Control chain restart</a></li><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#restart-the-rest-api-if-you-need" class="sidebar-link">Restart the REST API if you need</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#update-type-2-soft-fork" class="sidebar-link">Update type 2 - Soft fork</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#preliminary-risks-2" class="sidebar-link">Preliminary/Risks</a></li><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#setup-environment-2" class="sidebar-link">Setup environment</a></li><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#compile-new-executables-2" class="sidebar-link">Compile new executables</a></li><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#backup-executables-2" class="sidebar-link">Backup executables</a></li><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#restart-chain-changing-executables" class="sidebar-link">Restart chain changing executables</a></li><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#control-chain-restart-2" class="sidebar-link">Control chain restart</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#update-type-3-reset-reinstall-chain" class="sidebar-link">Update type 3 - Reset/reinstall chain</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#backup-executables-3" class="sidebar-link">Backup executables</a></li><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#backup-chain-database" class="sidebar-link">Backup chain database</a></li><li class="sidebar-sub-header"><a href="/docs2.2.0/nodes/validator-node-update.html#reinstall-node" class="sidebar-link">Reinstall node</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>App Developers</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>SDK Developers</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Modules</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ver 2.1.2</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="updating-a-validator"><a href="#updating-a-validator" class="header-anchor">#</a> Updating a validator</h1> <div class="custom-block danger"><p class="custom-block-title">DANGER</p> <p>If you are a new validator you need follow the <a href="/docs2.2.0/nodes/validator-node-installation.html"><em>&quot;Becoming a validator&quot;</em> procedure</a>.<br> <strong>DO NOT USE THIS UPDATE PROCEDURES</strong></p></div> <p>This section describes the procedure that needs to be followed in order to update a validator node from one
version to another.</p> <p>For updating will be sent to the validators the type and a brief explanation of the steps to be taken.<br>
This guide contains only a general basic explanation of the procedures to be applied.</p> <p>In general there are 3 types of updates</p> <ul><li>Update type <a href="#update-type-1-hard-fork"><code>1 - Hard fork</code></a></li> <li>Update type <a href="#update-type-2-soft-fork"><code>2 - Soft fork</code></a></li> <li>Update type <a href="#update-type-3-reset-reinstall-chain"><code>3 - Reset/reinstall chain</code></a></li></ul> <h2 id="update-type-1-hard-fork"><a href="#update-type-1-hard-fork" class="header-anchor">#</a> Update type 1 - Hard fork</h2> <p>In this case, the chain state will be preserved from its beginning to a certain point in time.</p> <h3 id="preliminary-risks"><a href="#preliminary-risks" class="header-anchor">#</a> Preliminary/Risks</h3> <p>When signalling a required update that should follow this procedure, the following information will
be let known to all validators:</p> <ol><li>A specific block height to stop chain: <code>&lt;stop_block_height&gt;</code></li> <li>The new chain software version: <code>&lt;new_version&gt;</code></li> <li>A deadline expressed in UTC format</li> <li>A new genesis_time in UTC format (something like 2020-06-12T08:55:00Z): <code>&lt;genesis_time&gt;</code></li> <li>The new chain_id: <code>&lt;new_chain_id&gt;</code></li> <li>The old chain_id: <code>&lt;old_chain_id&gt;</code></li></ol> <p>If you are a validator, please make sure that you know all those information before proceeding with the update.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>You should reach <a href="#setup-height-to-stop-the-chain">Setup height to stop the chain</a> point before update event.<br>
You prepare all settings as soon as you become aware of the update data</p></div> <div class="custom-block danger"><p class="custom-block-title">Double signing</p> <p>Due to the nature of the update operations, there is some risk of double signature.
To avoid every sort of risks please verify the software version, the hash of the <code>genesis.json</code> file and the specific
configuration present inside the <code>config.toml</code> file.</p></div> <div class="custom-block danger"><p class="custom-block-title">DANGER</p> <p>Update time<br>
The deadline of the update must be respected: every validator that will not update just in time will be slashed as offline node.</p></div> <h3 id="install-support-software"><a href="#install-support-software" class="header-anchor">#</a> Install support software</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> jq -y
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="setup-environment"><a href="#setup-environment" class="header-anchor">#</a> Setup environment</h3> <p>Each validator has its own specific environment and therefore will have to modify the variables according to its setup.<br> <strong>The following setups are general guidelines</strong></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> <span class="token environment constant">$HOME</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">UPDATE_PROFILE</span><span class="token operator">=</span><span class="token string">&quot;<span class="token environment constant">$HOME</span>/.profile_update_cnd&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token string">'export HOME_CND=&quot;'</span><span class="token environment constant">$HOME</span><span class="token string">'/.cnd&quot;'</span> <span class="token operator">&gt;</span> <span class="token variable">$UPDATE_PROFILE</span>
<span class="token builtin class-name">echo</span> <span class="token string">'export HOME_CND_CONFIG=&quot;$HOME_CND/config&quot;'</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">$UPDATE_PROFILE</span>
<span class="token builtin class-name">echo</span> <span class="token string">'export HOME_CND_DATA=&quot;$HOME_CND/data&quot;'</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">$UPDATE_PROFILE</span>
<span class="token builtin class-name">echo</span> <span class="token string">'export HOME_CNCLI=&quot;'</span><span class="token environment constant">$HOME</span><span class="token string">'/.cncli&quot;'</span> <span class="token operator">&gt;</span> <span class="token variable">$UPDATE_PROFILE</span>
<span class="token builtin class-name">echo</span> <span class="token string">'export APP_TOML=&quot;$HOME_CND_CONFIG/app.toml&quot;'</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">$UPDATE_PROFILE</span>
<span class="token builtin class-name">echo</span> <span class="token string">'export BIN_DIR=&quot;'</span><span class="token environment constant">$HOME</span><span class="token string">'/go/bin&quot;'</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">$UPDATE_PROFILE</span>
<span class="token builtin class-name">echo</span> <span class="token string">'export SRC_GIT_DIR=&quot;'</span><span class="token environment constant">$HOME</span><span class="token string">'/commercionetwork&quot;'</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">$UPDATE_PROFILE</span>
<span class="token builtin class-name">echo</span> <span class="token string">'export BUILD_DIR=&quot;$SRC_GIT_DIR/build&quot;'</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">$UPDATE_PROFILE</span>
<span class="token builtin class-name">echo</span> <span class="token string">'export NEW_CHAIN_ID=&quot;&lt;new_chain_id&gt;&quot;'</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">$UPDATE_PROFILE</span>
<span class="token builtin class-name">echo</span> <span class="token string">'export CHAIN_ID=&quot;&lt;old_chain_id&gt;&quot;'</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">$UPDATE_PROFILE</span>
<span class="token builtin class-name">echo</span> <span class="token string">'export BUILD_VERSION=&quot;&lt;new_version&gt;&quot;'</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">$UPDATE_PROFILE</span>
<span class="token builtin class-name">echo</span> <span class="token string">'export ALT_BLOCK=&lt;stop_block_height&gt;'</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">$UPDATE_PROFILE</span>
<span class="token builtin class-name">echo</span> <span class="token string">'export NEW_GENESIS_TIME=&quot;&lt;genesis_time&gt;&quot;'</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">$UPDATE_PROFILE</span>

<span class="token builtin class-name">source</span> <span class="token variable">$UPDATE_PROFILE</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;. <span class="token variable">$UPDATE_PROFILE</span>&quot;</span> <span class="token operator">&gt;&gt;</span> <span class="token environment constant">$HOME</span>/.profile
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="compile-new-executables"><a href="#compile-new-executables" class="header-anchor">#</a> Compile new executables</h3> <p>In order to properly update your validator node, first of all you need to clone the
<a href="https://github.com/commercionetwork/commercionetwork" target="_blank" rel="noopener noreferrer"><code>commercionetwork</code> repo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> clone https://github.com/commercionetwork/commercionetwork.git <span class="token variable">$SRC_GIT_DIR</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Once downloaded, you need to compile the binaries with correct version:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> <span class="token variable">$SRC_GIT_DIR</span>
<span class="token function">git</span> pull
<span class="token function">git</span> checkout <span class="token variable">$BUILD_VERSION</span>
<span class="token function">git</span> pull
<span class="token function">make</span> build
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Verify your version</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>./build/cnd version
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>should be the same value of <code>&lt;new_version&gt;</code></p> <h3 id="setup-height-to-stop-the-chain"><a href="#setup-height-to-stop-the-chain" class="header-anchor">#</a> Setup height to stop the chain</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">sed</span> -e <span class="token string">&quot;s|halt-height = .*|halt-height = <span class="token variable">$ALT_BLOCK</span>|g&quot;</span> <span class="token punctuation">\</span>
  <span class="token variable">$APP_TOML</span> <span class="token operator">&gt;</span> <span class="token variable">$APP_TOML</span>.tmp
<span class="token function">mv</span> <span class="token variable">$APP_TOML</span>.tmp <span class="token variable">$APP_TOML</span>
<span class="token function">sudo</span> <span class="token function">service</span> cnd restart
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="control-if-chain-is-stopped"><a href="#control-if-chain-is-stopped" class="header-anchor">#</a> Control if chain is stopped</h3> <p>After the block <code>&lt;stop_block_height&gt;</code> a chain stop message should appear at the indicated block.
To verify that the chain is actually locked check with reading the logs</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> journalctl -u cnd -f
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="stop-services"><a href="#stop-services" class="header-anchor">#</a> Stop services</h3> <p>Make sure you have stopped services and export the chain</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> systemctl stop cnd
<span class="token function">sudo</span> systemctl stop cncli <span class="token comment"># if you running rest server</span>
<span class="token function">sudo</span> <span class="token function">pkill</span> cnd
<span class="token function">sudo</span> <span class="token function">pkill</span> cncli
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>and control it reading the logs</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> journalctl -u cnd -f
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="export-chain-state"><a href="#export-chain-state" class="header-anchor">#</a> Export chain state</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>cnd <span class="token builtin class-name">export</span> --for-zero-height <span class="token operator">&gt;</span> <span class="token environment constant">$HOME</span>/export_for_<span class="token variable">$NEW_CHAIN_ID</span>.json
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="backup-executables"><a href="#backup-executables" class="header-anchor">#</a> Backup executables</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">cp</span> -r <span class="token variable">$BIN_DIR</span>/cnd <span class="token variable">$BIN_DIR</span>/cnd.back
<span class="token function">cp</span> -r <span class="token variable">$BIN_DIR</span>/cncli <span class="token variable">$BIN_DIR</span>/cncli.back
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="changing-executables"><a href="#changing-executables" class="header-anchor">#</a> Changing executables</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">cp</span> <span class="token variable">$BUILD_DIR</span>/cn* <span class="token variable">$BIN_DIR</span>/.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="migrate-chain"><a href="#migrate-chain" class="header-anchor">#</a> Migrate chain</h3> <p>Try to find out migrate version from list of current migration</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>cnd migrations-list 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>If you find <code>&lt;new_version&gt;</code> in the ouput command you ca use the follow command</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>cnd migrate <span class="token punctuation">\</span>
  <span class="token variable">$BUILD_VERSION</span> <span class="token punctuation">\</span>
  <span class="token environment constant">$HOME</span>/export_for_<span class="token variable">$NEW_CHAIN_ID</span>.json <span class="token punctuation">\</span>
  --chain-id <span class="token variable">$NEW_CHAIN_ID</span> <span class="token punctuation">\</span>     
  --genesis-time <span class="token variable">$NEW_GENESIS_TIME</span> <span class="token operator">&gt;</span> <span class="token punctuation">\</span>
  <span class="token environment constant">$HOME</span>/genesis_for_<span class="token variable">$NEW_CHAIN_ID</span>.json
  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>If you don't find <code>&lt;new_version&gt;</code> in the valid migrations list use</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">cat</span> <span class="token environment constant">$HOME</span>/export_for_<span class="token variable">$NEW_CHAIN_ID</span>.json <span class="token operator">|</span> <span class="token punctuation">\</span>
  jq <span class="token string">'.genesis_time=&quot;'</span><span class="token variable">$NEW_GENESIS_TIME</span><span class="token string">'&quot;'</span> <span class="token operator">|</span> <span class="token punctuation">\</span>
  jq <span class="token string">'.chain_id=&quot;'</span><span class="token variable">$NEW_CHAIN_ID</span><span class="token string">'&quot;'</span> <span class="token operator">&gt;</span> <span class="token punctuation">\</span>
  <span class="token environment constant">$HOME</span>/genesis_for_<span class="token variable">$NEW_CHAIN_ID</span>.json
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="check-hash-of-genesis"><a href="#check-hash-of-genesis" class="header-anchor">#</a> Check hash of genesis</h3> <p>To confirm that all validator nodes have produced the same genesis, a comparison must be made between all update participants to demonstrate the consistency of the data.</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>jq -S -c -M <span class="token string">''</span> <span class="token environment constant">$HOME</span>/genesis_for_<span class="token variable">$NEW_CHAIN_ID</span>.json <span class="token operator">|</span> shasum -a <span class="token number">256</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Compare the value of the hash obtained with all other participants in the update</p> <h3 id="backup"><a href="#backup" class="header-anchor">#</a> Backup</h3> <p>Before starting the update it is recommended to take a full data snapshot of the chain state at the export height.<br>
To do so please run:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>systemctl stop cnd
systemctl stop cncli <span class="token comment"># if you running rest server</span>
<span class="token function">mkdir</span> <span class="token variable">$HOME_CND</span><span class="token builtin class-name">.</span><span class="token variable">$CHAIN_ID</span>
<span class="token function">mv</span> <span class="token variable">$HOME_CND_DATA</span> <span class="token variable">$HOME_CND</span><span class="token builtin class-name">.</span><span class="token variable">$CHAIN_ID</span>/.
<span class="token function">cp</span> -r <span class="token variable">$HOME_CND_CONFIG</span> <span class="token variable">$HOME_CND</span><span class="token builtin class-name">.</span><span class="token variable">$CHAIN_ID</span>/.
<span class="token function">cp</span> -r <span class="token variable">$HOME_CNCLI</span> <span class="token variable">$HOME_CNCLI</span><span class="token builtin class-name">.</span><span class="token variable">$CHAIN_ID</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="reset-chain-and-change-geneis-file"><a href="#reset-chain-and-change-geneis-file" class="header-anchor">#</a> Reset chain and change geneis file</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>cnd unsafe-reset-all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">cp</span> <span class="token environment constant">$HOME</span>/genesis_for_<span class="token variable">$NEW_CHAIN_ID</span>.json <span class="token variable">$HOME_CND_CONFIG</span>/genesis.json
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="restart-chain"><a href="#restart-chain" class="header-anchor">#</a> Restart chain</h3> <p>Before restarting the chain we have to reset the value for height for the stop to zero.</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">sed</span> -e <span class="token string">&quot;s|halt-height = .*|halt-height = 0|g&quot;</span> <span class="token punctuation">\</span>
  <span class="token variable">$APP_TOML</span> <span class="token operator">&gt;</span> <span class="token variable">$APP_TOML</span>.tmp
<span class="token function">mv</span> <span class="token variable">$APP_TOML</span>.tmp <span class="token variable">$APP_TOML</span>
systemctl start cnd
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="control-chain-restart"><a href="#control-chain-restart" class="header-anchor">#</a> Control chain restart</h3> <p>The new chain should restart at the time set in the <code>genesis_time</code>.<br>
Control if the sync starts. Use <code>Ctrl + C</code> to interrupt the <code>journalctl</code> command</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>journalctl -u cnd -f
<span class="token comment"># OUTPUT SHOULD BE LIKE BELOW AFTER GENESI TIME</span>
<span class="token comment">#</span>
<span class="token comment"># Aug 13 16:30:20 commerciotestnet-node4 cnd[351]: I[2019-08-13|16:30:20.722] Executed block                               module=state height=1 validTxs=0 invalidTxs=0</span>
<span class="token comment"># Aug 13 16:30:20 commerciotestnet-node4 cnd[351]: I[2019-08-13|16:30:20.728] Committed state                              module=state height=1 txs=0 appHash=9815044185EB222CE9084AA467A156DFE6B4A0B1BAAC6751DE86BB31C83C4B08</span>
<span class="token comment"># Aug 13 16:30:20 commerciotestnet-node4 cnd[351]: I[2019-08-13|16:30:20.745] Executed block                               module=state height=2 validTxs=0 invalidTxs=0</span>
<span class="token comment"># Aug 13 16:30:20 commerciotestnet-node4 cnd[351]: I[2019-08-13|16:30:20.751] Committed state                              module=state height=2 txs=0 appHash=96BFD9C8714A79193A7913E5F091470691B195E1E6F028BC46D6B1423F7508A5</span>
<span class="token comment"># Aug 13 16:30:20 commerciotestnet-node4 cnd[351]: I[2019-08-13|16:30:20.771] Executed block                               module=state height=3 validTxs=0 invalidTxs=0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="restart-the-rest-api-if-you-need"><a href="#restart-the-rest-api-if-you-need" class="header-anchor">#</a> Restart the REST API if you need</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>cncli config chain-id $NEW_CHAIN_ID
cncli rest-server --chain-id $NEW_CHAIN_ID --trust-node
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="update-type-2-soft-fork"><a href="#update-type-2-soft-fork" class="header-anchor">#</a> Update type 2 - Soft fork</h2> <p>This type of upgrade is generally optional: it is released to fix some minor bugs in the software and does not change the status of the chain</p> <h3 id="preliminary-risks-2"><a href="#preliminary-risks-2" class="header-anchor">#</a> Preliminary/Risks</h3> <p>When signalling a optional update that should follow this procedure, the following information will
be let known to all validators:</p> <ol><li>The new chain software version: <code>&lt;new_version&gt;</code></li></ol> <p>If you are a validator, please make sure that you know all those information before proceeding with the update.</p> <h3 id="setup-environment-2"><a href="#setup-environment-2" class="header-anchor">#</a> Setup environment</h3> <p>Each validator has its own specific environment and therefore will have to modify the variables according to its setup.<br> <strong>The following setups are general guidelines</strong></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> <span class="token environment constant">$HOME</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">UPDATE_PROFILE</span><span class="token operator">=</span><span class="token string">&quot;<span class="token environment constant">$HOME</span>/.profile_update_cnd&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token string">'export HOME_CND=&quot;'</span><span class="token environment constant">$HOME</span><span class="token string">'/.cnd&quot;'</span> <span class="token operator">&gt;</span> <span class="token variable">$UPDATE_PROFILE</span>
<span class="token builtin class-name">echo</span> <span class="token string">'export HOME_CND_CONFIG=&quot;$HOME_CND/config&quot;'</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">$UPDATE_PROFILE</span>
<span class="token builtin class-name">echo</span> <span class="token string">'export HOME_CND_DATA=&quot;$HOME_CND/data&quot;'</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">$UPDATE_PROFILE</span>
<span class="token builtin class-name">echo</span> <span class="token string">'export BIN_DIR=&quot;'</span><span class="token environment constant">$HOME</span><span class="token string">'/go/bin&quot;'</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">$UPDATE_PROFILE</span>
<span class="token builtin class-name">echo</span> <span class="token string">'export SRC_GIT_DIR=&quot;'</span><span class="token environment constant">$HOME</span><span class="token string">'/commercionetwork&quot;'</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">$UPDATE_PROFILE</span>
<span class="token builtin class-name">echo</span> <span class="token string">'export BUILD_DIR=&quot;$SRC_GIT_DIR/build&quot;'</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">$UPDATE_PROFILE</span>
<span class="token builtin class-name">echo</span> <span class="token string">'export BUILD_VERSION=&quot;&lt;new_version&gt;&quot;'</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">$UPDATE_PROFILE</span>

<span class="token builtin class-name">source</span> <span class="token variable">$UPDATE_PROFILE</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;. <span class="token variable">$UPDATE_PROFILE</span>&quot;</span> <span class="token operator">&gt;&gt;</span> <span class="token environment constant">$HOME</span>/.profile
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="compile-new-executables-2"><a href="#compile-new-executables-2" class="header-anchor">#</a> Compile new executables</h3> <p>In order to properly update your validator node, first of all you need to clone the
<a href="https://github.com/commercionetwork/commercionetwork" target="_blank" rel="noopener noreferrer"><code>commercionetwork</code> repo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> clone https://github.com/commercionetwork/commercionetwork.git <span class="token variable">$SRC_GIT_DIR</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Once downloaded, you need to compile the binaries with correct version:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> <span class="token variable">$SRC_GIT_DIR</span>
<span class="token function">git</span> pull
<span class="token function">git</span> checkout <span class="token variable">$BUILD_VERSION</span>
<span class="token function">git</span> pull
<span class="token function">make</span> build
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Verify your version</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>./build/cnd version
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>should be the same value of <code>&lt;new_version&gt;</code></p> <h3 id="backup-executables-2"><a href="#backup-executables-2" class="header-anchor">#</a> Backup executables</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">cp</span> -r <span class="token variable">$BIN_DIR</span>/cnd <span class="token variable">$BIN_DIR</span>/cnd.back
<span class="token function">cp</span> -r <span class="token variable">$BIN_DIR</span>/cncli <span class="token variable">$BIN_DIR</span>/cncli.back
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="restart-chain-changing-executables"><a href="#restart-chain-changing-executables" class="header-anchor">#</a> Restart chain changing executables</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> systemctl stop cnd
<span class="token function">sudo</span> systemctl stop cncli
<span class="token function">cp</span> <span class="token variable">$BUILD_DIR</span>/cn* <span class="token variable">$BIN_DIR</span>/.
<span class="token function">sudo</span> systemctl start cnd
<span class="token function">sudo</span> systemctl start cncli

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="control-chain-restart-2"><a href="#control-chain-restart-2" class="header-anchor">#</a> Control chain restart</h3> <p>The new chain should restart at the time set in the <code>genesis_time</code>.<br>
Control if the sync starts. Use <code>Ctrl + C</code> to interrupt the <code>journalctl</code> command</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>journalctl -u cnd -f
<span class="token comment"># OUTPUT SHOULD BE LIKE BELOW AFTER GENESI TIME</span>
<span class="token comment">#</span>
<span class="token comment"># Aug 13 16:30:20 commerciotestnet-node4 cnd[351]: I[2019-08-13|16:30:20.722] Executed block                               module=state height=1 validTxs=0 invalidTxs=0</span>
<span class="token comment"># Aug 13 16:30:20 commerciotestnet-node4 cnd[351]: I[2019-08-13|16:30:20.728] Committed state                              module=state height=1 txs=0 appHash=9815044185EB222CE9084AA467A156DFE6B4A0B1BAAC6751DE86BB31C83C4B08</span>
<span class="token comment"># Aug 13 16:30:20 commerciotestnet-node4 cnd[351]: I[2019-08-13|16:30:20.745] Executed block                               module=state height=2 validTxs=0 invalidTxs=0</span>
<span class="token comment"># Aug 13 16:30:20 commerciotestnet-node4 cnd[351]: I[2019-08-13|16:30:20.751] Committed state                              module=state height=2 txs=0 appHash=96BFD9C8714A79193A7913E5F091470691B195E1E6F028BC46D6B1423F7508A5</span>
<span class="token comment"># Aug 13 16:30:20 commerciotestnet-node4 cnd[351]: I[2019-08-13|16:30:20.771] Executed block                               module=state height=3 validTxs=0 invalidTxs=0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="update-type-3-reset-reinstall-chain"><a href="#update-type-3-reset-reinstall-chain" class="header-anchor">#</a> Update type 3 - Reset/reinstall chain</h2> <p>This procedure is very rare and is only performed in borderline cases.<br>
With this process the chain is completely reinitialized and a new genesis is produced by the chain management system.<br>
Usually this procedure is applied on development and test chains.</p> <h3 id="backup-executables-3"><a href="#backup-executables-3" class="header-anchor">#</a> Backup executables</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">cp</span> -r <span class="token variable">$BIN_DIR</span>/cnd <span class="token variable">$BIN_DIR</span>/cnd.back
<span class="token function">cp</span> -r <span class="token variable">$BIN_DIR</span>/cncli <span class="token variable">$BIN_DIR</span>/cncli.back
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="backup-chain-database"><a href="#backup-chain-database" class="header-anchor">#</a> Backup chain database</h3> <p>Before starting the update it is recommended to take a full data snapshot of the chain state at the export height.<br>
To do so please run:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>systemctl stop cnd
systemctl stop cncli <span class="token comment"># if you running rest server</span>
<span class="token function">mkdir</span> <span class="token variable">$HOME_CND</span><span class="token builtin class-name">.</span><span class="token variable">$CHAIN_ID</span>
<span class="token function">mv</span> <span class="token variable">$HOME_CND_DATA</span> <span class="token variable">$HOME_CND</span><span class="token builtin class-name">.</span><span class="token variable">$CHAIN_ID</span>/.
<span class="token function">cp</span> -r <span class="token variable">$HOME_CND_CONFIG</span> <span class="token variable">$HOME_CND</span><span class="token builtin class-name">.</span><span class="token variable">$CHAIN_ID</span>/.
<span class="token function">cp</span> -r <span class="token variable">$HOME_CNCLI</span> <span class="token variable">$HOME_CNCLI</span><span class="token builtin class-name">.</span><span class="token variable">$CHAIN_ID</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="reinstall-node"><a href="#reinstall-node" class="header-anchor">#</a> Reinstall node</h3> <p>Follow all steps in <a href="/docs2.2.0/nodes/full-node-installation.html">Installing a full node</a><br>
Follow all steps in <a href="/docs2.2.0/nodes/validator-node-installation.html">Becoming a validator</a></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/commercionetwork/commercionetwork/edit/master/docs/docs2.2.0/nodes/validator-node-update.md" target="_blank" rel="noopener noreferrer">Edit this page on Github</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2/23/2022, 8:04:07 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs2.2.0/nodes/validator-node-handling.html" class="prev">
        Handling a validator
      </a></span> <span class="next"><a href="/docs2.2.0/app_developers/">
        Introduction
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.cb75fd21.js" defer></script><script src="/assets/js/2.0061f73b.js" defer></script><script src="/assets/js/78.05820fe7.js" defer></script>
  </body>
</html>
